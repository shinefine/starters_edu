
<table class ="ui celled collapsing table segment">
  <thead>
  <tr>

    <th>CR涨分情况</th>
    <th>Math涨分情况</th>
    <th >Writing涨分情况</th>
    <th >总分涨分情况</th>

  </tr>
  </thead>


  <tbody>
  <tr>
    <%subject_names=['Reading','Math','Writing','Total']%>

    <% subject_names.each do|subject_name|%>


        <td class="colored_content">
          <!--此单元格显示多个表格,这些表格分组显示了语法涨分情况-->
          <%students =@hash_students_score_trend.keys
            trend_ranges = [0...50,50...100,100...150,150...200]

            hash_grp=students.group_by{|stu|
              score_trend_result = @hash_students_score_trend[stu]
              trend_result = stu.get_trend_result_by_subject_name(subject_name,score_trend_result)

              helper__summary_value_in_which_range(trend_result,trend_ranges) #值为'0~50分'或'200分以上'或...
            }
          %>


          <%score_block =helper__range_block_summary_text(trend_ranges).reverse %>

          <%score_block.each do|key_string|%>
              <%stu_list = hash_grp[key_string] ||[] %>
              <table class ="ui celled collapsing table segment">

                <thead>

                <tr>
                  <th colspan="3" >进步<%=key_string%> <%=stu_list.count%>个</th>
                </tr>

                <% if stu_list.count >0%>
                    <tr>

                      <th></th>
                      <th>最高分</th>
                      <th >分数变化</th>

                    </tr>
                <%end%>

                </thead>


                <tbody>

                <%stu_list.each do |stu|%>
                    <tr>
                      <td><%=stu.name%></td>
                      <%method_name = subject_name.downcase%>

                      <td><%=@hash_students_score_trend[stu].fetch(('max_real_score_sat_' + method_name).to_sym)%></td>
                      <td><%=@hash_students_score_trend[stu].fetch(('score_trend_sat_'+ method_name).to_sym)%></td>

                    </tr>

                <%end%>
                </tbody>
              </table>
          <%end%>

        </td>
    <%end%>

  </tr>

  </tbody>
</table>
