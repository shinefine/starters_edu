<!--本局部试图属于 index_for_all_students.html.erb ,用于显示所有学员的某次特定模拟考试的(SAT)成绩列表-->

<table class ="ui celled table segment">
  <thead>
  <tr>

    <th></th>
    <th>总分</th>

    <%if can_view_subject('语法' , @training_class,current_user) %>
        <th  colspan="8">Critical Reading</th>
    <%end%>

    <%if can_view_subject('数学' , @training_class,current_user) %>
        <th  colspan="5">Mathematics</th>
    <%end%>

    <%if can_view_subject('作文' , @training_class,current_user) %>
        <th colspan="6">Writing </th>
    <%end%>

    <th></th>
  </tr>
  </thead>
  <tr>

    <th>学员</th>
    <th></th>

    <%if can_view_subject('语法' , @training_class,current_user) %>
    <th>CR总分 </th> <th>raw score </th>
    <th>词汇正确 </th> <th>词汇错误 </th><th>词汇空 </th>
    <th>阅读正确 </th> <th>阅读错误 </th><th>阅读空 </th>
    <%end%>

    <%if can_view_subject('数学' , @training_class,current_user) %>
    <th>Math总分 </th> <th>raw score </th>
    <th>正确 </th> <th>错误 </th><th>空 </th>
    <%end%>

    <%if can_view_subject('写作' , @training_class,current_user) %>
    <th>Writing 得分</th><th>raw score </th>
    <th>正确 </th> <th>错误 </th><th>空 </th>
    <th>作文</th>
    <%end%>
    <th></th>
  </tr>
  <tbody>
  <% @training_class_students.each do |student| %>

      <% score = @scores.where(student_id: student).first %>

      <tr>
        <td><%= student.name %></td>

        <td class="lightgreen"><%= score.try(:final_score) %> </td>
        <%if can_view_subject('语法' , @training_class,current_user) %>
            <td><%= score.try(:course_a_score) %></td>
            <td><%= score.try(:stat_07) %></td>
            <td><%= score.try(:stat_01) %></td>
            <td><%= score.try(:stat_02) %></td>
            <td><%= score.try(:stat_03) %></td>
            <td><%= score.try(:stat_04) %></td>
            <td><%= score.try(:stat_05) %></td>
            <td><%= score.try(:stat_06) %></td>
        <%end%>

        <%if can_view_subject('数学' , @training_class,current_user) %>
            <td class="lightgray"><%= score.try(:course_b_score) %></td>
            <td><%= score.try(:stat_11) %></td>
            <td><%= score.try(:stat_08) %></td>
            <td><%= score.try(:stat_09) %></td>
            <td><%= score.try(:stat_10) %></td>
        <%end%>

        <%if can_view_subject('写作' , @training_class,current_user) %>
            <td class="lightgray"><%= score.try(:course_c_score) %></td>
            <td><%= score.try(:stat_15) %></td>
            <td><%= score.try(:stat_12) %></td>
            <td><%= score.try(:stat_13) %></td>
            <td><%= score.try(:stat_14) %></td>
            <td><%= score.try(:stat_16) %></td>
        <%end%>


        <% if current_user.teacher? %>
             <td></td><td></td>
        <% else %>
            <%if score.nil?%>
                <td><%= link_to "录入考试成绩" , new_student_examination_score_path(student,@examination),{class:'ui green button'} %></td>
            <%else%>
                <td><%= link_to "修改考试成绩" , edit_student_examination_score_path(student,@examination,score) ,{class:'ui green button'}%></td>
            <% end %>
        <% end %>
      </tr>
  <% end %>
  </tbody>
</table>